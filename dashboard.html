<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kevin's Gamified Exam Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
/* ----------- RESET ----------- */
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Roboto',sans-serif;background:#121212;color:#eee;overflow-x:hidden;}

/* ----------- HEADER ----------- */
header{background:#1f1f2f;color:#fff;text-align:center;padding:1rem;font-size:2rem;position:sticky;top:0;z-index:100;box-shadow:0 2px 10px rgba(0,0,0,0.5);}
#countdown{font-size:1.2rem;margin-top:0.3rem;color:#ffcc00;font-weight:700;}

/* ----------- STATS ----------- */
.stats{display:flex;justify-content:space-around;padding:1rem;margin:1rem auto;max-width:900px;}
.stat-box{background:#222;border-radius:10px;padding:0.8rem 1rem;text-align:center;flex:1;margin:0 0.5rem;box-shadow:0 2px 8px rgba(0,0,0,0.5);}
.stat-box h3{color:#ffcc00;margin-bottom:0.3rem;}

/* ----------- CONTAINER ----------- */
.container{max-width:1000px;margin:0 auto;padding:1rem;display:flex;flex-direction:column;gap:1rem;}

/* ----------- DAY CARD ----------- */
.day-card{background:#1f1f2f;border-radius:15px;overflow:hidden;box-shadow:0 4px 12px rgba(0,0,0,0.5);transition:transform 0.3s;}
.day-card:hover{transform:translateY(-5px);}
.day-header{padding:1rem;text-align:center;font-size:1.3rem;background:#27273a;cursor:pointer;position:relative;}
.day-header span{position:absolute;right:1rem;top:50%;transform:translateY(-50%);font-size:1.2rem;}
.tasks{display:flex;flex-direction:column;gap:0.5rem;padding:1rem;}

/* ----------- TASK CARD ----------- */
.task{display:flex;justify-content:space-between;align-items:center;padding:0.5rem 1rem;border-radius:10px;cursor:pointer;transition:all 0.3s;font-weight:500;}
.task span{flex:1;}
.task.completed{opacity:0.6;text-decoration:line-through;}
.task button{border:none;background:#ffcc00;color:#121212;padding:0.3rem 0.6rem;border-radius:5px;cursor:pointer;transition:0.3s;}
.task button:hover{background:#ffd633;}

/* ----------- SUBJECT COLORS ----------- */
.TPDE{background:#ff4d6d;color:#121212;}
.DEM{background:#ff944d;color:#121212;}
.EDA{background:#fffb6b;color:#121212;}
.KDM{background:#42ff99;color:#121212;}
.MT{background:#4da6ff;color:#121212;}
.UHV{background:#bb99ff;color:#121212;}
.GYM{background:#aaaaaa;color:#121212;}

/* ----------- PROGRESS ----------- */
.progress-bar{width:100%;background:#333;height:12px;border-radius:10px;margin-top:0.5rem;overflow:hidden;}
.progress{height:100%;background:#ffcc00;width:0%;transition:width 0.5s;}

/* ----------- SLIDE ANIMATION ----------- */
.day-card.hide{max-height:0;padding:0;margin:0;overflow:hidden;transition:max-height 0.5s ease, padding 0.5s ease, margin 0.5s ease;}
.day-card.show{max-height:1000px;padding:1rem;margin:1rem 0;transition:max-height 0.5s ease, padding 0.5s ease, margin 0.5s ease;}

/* ----------- FLASHCARDS / MODAL ----------- */
.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);display:none;justify-content:center;align-items:center;z-index:200;}
.modal-content{background:#1f1f2f;padding:2rem;border-radius:15px;max-width:500px;width:90%;text-align:center;position:relative;}
.modal-content h3{margin-bottom:1rem;}
.modal-content button{margin-top:1rem;background:#ffcc00;color:#121212;border:none;padding:0.5rem 1rem;border-radius:10px;cursor:pointer;}

/* ----------- CONFETTI CANVAS ----------- */
#confetti-canvas{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:300;}

/* ----------- RESPONSIVE ----------- */
@media(max-width:600px){.task{flex-direction:column;align-items:flex-start;}.task button{margin-top:0.3rem;}}
</style>
</head>
<body>

<header>
Kevin's Gamified Exam Dashboard
<div id="countdown">Loading countdown...</div>
</header>

<div class="stats">
<div class="stat-box"><h3 id="points">0</h3>Points</div>
<div class="stat-box"><h3 id="streak">0</h3>Streak</div>
<div class="stat-box"><h3 id="dayProgress">0%</h3>Day Progress</div>
</div>

<div class="container" id="daysContainer"></div>

<div class="modal" id="flashcardModal">
<div class="modal-content">
<h3>Flashcard / Mini Quiz</h3>
<p id="flashcardText">Placeholder for flashcards.</p>
<button onclick="closeFlashcard()">Close</button>
</div>
</div>

<canvas id="confetti-canvas"></canvas>

<script>
// ---------- CONFIG ----------
const examDate = new Date("2025-10-10T00:00:00+05:30"); // IST
const schedule = [
  {day:"Oct 1", tasks:[
    {time:"6–9 AM", subject:"TPDE", task:"TPDE U1 Laplace"},
    {time:"9:30–11:30 AM", subject:"MT", task:"MT U1 Casting"},
    {time:"11:30–12:30 PM", subject:"GYM", task:"Gym"},
    {time:"1–3 PM", subject:"MT", task:"MT U2 Forming"},
    {time:"3:30–5 PM", subject:"TPDE", task:"TPDE Practice"},
    {time:"6:30–8 PM", subject:"MT", task:"Finish MT U2 + Diagrams"},
    {time:"8:30–10 PM", subject:"TPDE", task:"Flashcards TPDE + MT"}
  ]},
  {day:"Oct 2", tasks:[
    {time:"6–9 AM", subject:"TPDE", task:"TPDE U2 Fourier"},
    {time:"9:30–11:30 AM", subject:"DEM", task:"DEM U1 Logic Gates"},
    {time:"11:30–12:30 PM", subject:"GYM", task:"Gym"},
    {time:"1–3 PM", subject:"EDA", task:"EDA U1 Electrical Drives"},
    {time:"3:30–5 PM", subject:"TPDE", task:"TPDE Practice"},
    {time:"6:30–8 PM", subject:"DEM", task:"DEM Practice"},
    {time:"8:30–10 PM", subject:"TPDE", task:"Flashcards TPDE + DEM"}
  ]},
  {day:"Oct 3", tasks:[
    {time:"6–9 AM", subject:"TPDE", task:"TPDE U3 PDE Methods"},
    {time:"9:30–11:30 AM", subject:"DEM", task:"DEM U2 Combinational Circuits"},
    {time:"11:30–12:30 PM", subject:"GYM", task:"Gym"},
    {time:"1–3 PM", subject:"EDA", task:"EDA U2 Converters"},
    {time:"3:30–5 PM", subject:"KDM", task:"KDM U3 Acceleration & Forces"},
    {time:"5:30–7 PM", subject:"MT", task:"MT U3 Machining"},
    {time:"7:30–9 PM", subject:"TPDE", task:"TPDE Practice"}
  ]},
  // Continue days 4–9 similarly...
];

// ---------- LOCAL STORAGE ----------
let tasksState = JSON.parse(localStorage.getItem("tasksState")) || {};
let points = Number(localStorage.getItem("points")) || 0;
let streak = Number(localStorage.getItem("streak")) || 0;

// ---------- CREATE DASHBOARD ----------
const container = document.getElementById("daysContainer");

function createTaskCard(dayIndex, taskIndex, task){
  const card = document.createElement("div");
  card.className = `task ${task.subject}`;
  if(tasksState[dayIndex]?.[taskIndex]) card.classList.add("completed");
  
  const span = document.createElement("span");
  span.textContent = `${task.time}: ${task.task}`;
  card.appendChild(span);
  
  const btn = document.createElement("button");
  btn.textContent="Done";
  btn.onclick=(e)=>{
    e.stopPropagation();
    toggleTask(dayIndex,taskIndex,card);
  };
  card.appendChild(btn);
  
  card.onclick = ()=>openFlashcard(task.task);
  
  return card;
}

function createDayCard(dayObj, dayIndex){
  const card = document.createElement("div");
  card.className="day-card show";
  const header = document.createElement("div");
  header.className="day-header";
  header.textContent = dayObj.day;
  const toggleIcon = document.createElement("span");
  toggleIcon.textContent="▼";
  header.appendChild(toggleIcon);
  let open=true;
  header.onclick=()=>{
    open=!open;
    card.classList.toggle("hide",!open);
  };
  card.appendChild(header);
  
  const tasksDiv = document.createElement("div");
  tasksDiv.className="tasks";
  dayObj.tasks.forEach((task,idx)=>{
    const tcard = createTaskCard(dayIndex,idx,task);
    tasksDiv.appendChild(tcard);
  });
  card.appendChild(tasksDiv);
  
  const progressDiv = document.createElement("div");
  progressDiv.className="progress-bar";
  const progressInner = document.createElement("div");
  progressInner.className="progress";
  progressDiv.appendChild(progressInner);
  card.appendChild(progressDiv);
  
  container.appendChild(card);
}

schedule.forEach((dayObj,dayIdx)=>createDayCard(dayObj,dayIdx));

// ---------- TASK TOGGLE ----------
function toggleTask(dayIdx,taskIdx,card){
  tasksState[dayIdx] = tasksState[dayIdx]||{};
  const completed = !tasksState[dayIdx][taskIdx];
  tasksState[dayIdx][taskIdx] = completed;
  if(completed){card.classList.add("completed"); points+=10;} 
  else{card.classList.remove("completed"); points-=10;}
  localStorage.setItem("tasksState",JSON.stringify(tasksState));
  localStorage.setItem("points",points);
  document.getElementById("points").textContent = points;
  updateDayProgress(dayIdx);
  checkDayCompletion(dayIdx);
}

// ---------- DAY PROGRESS ----------
function updateDayProgress(dayIdx){
  const dayTasks = Object.values(tasksState[dayIdx]||{});
  const completed = dayTasks.filter(t=>t).length;
  const total = schedule[dayIdx].tasks.length;
  const percent = Math.floor(completed/total*100);
  const progress = container.children[dayIdx].querySelector(".progress");
  progress.style.width = percent+"%";
  document.getElementById("dayProgress").textContent = percent+"%";
}

// ---------- CHECK COMPLETION & STREAK ----------
function checkDayCompletion(dayIdx){
  const dayTasks = Object.values(tasksState[dayIdx]||{});
  const allDone = dayTasks.every(t=>t);
  if(allDone){
    streak++;
    localStorage.setItem("streak",streak);
    document.getElementById("streak").textContent = streak;
    launchConfetti();
  }
}

// ---------- FLASHCARD ----------
function openFlashcard(task){
  document.getElementById("flashcardText").textContent = task+" - Flashcard / Mini Quiz Placeholder";
  document.getElementById("flashcardModal").style.display="flex";
}
function closeFlashcard(){document.getElementById("flashcardModal").style.display="none";}

// ---------- COUNTDOWN ----------
function updateCountdown(){
  const now = new Date();
  const diff = examDate-now;
  if(diff<0){document.getElementById("countdown").textContent="Exam Started!";return;}
  const d = Math.floor(diff/1000/60/60/24);
  const h = Math.floor(diff/1000/60/60)%24;
  const m = Math.floor(diff/1000/60)%60;
  const s = Math.floor(diff/1000)%60;
  document.getElementById("countdown").textContent=`Exam in ${d}d ${h}h ${m}m ${s}s`;
}
setInterval(updateCountdown,1000);
updateCountdown();

// ---------- CONFETTI ----------
const confettiCanvas = document.getElementById("confetti-canvas");
const ctx = confettiCanvas.getContext("2d");
confettiCanvas.width = window.innerWidth;
confettiCanvas.height = window.innerHeight;
let confettis=[];
function launchConfetti(){
  for(let i=0;i<150;i++){
    confettis.push({x:Math.random()*confettiCanvas.width,y:Math.random()*confettiCanvas.height,dx:(Math.random()-0.5)*3,dy:(Math.random()-1)*3,color:`hsl(${Math.random()*360},100%,50%)`,r:Math.random()*4+1});
  }
  requestAnimationFrame(updateConfetti);
}
function updateConfetti(){
  ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
  confettis.forEach(c=>{
    ctx.fillStyle=c.color;
    ctx.beginPath();
    ctx.arc(c.x,c.y,c.r,0,Math.PI*2);
    ctx.fill();
    c.x+=c.dx; c.y+=c.dy+1;
    if(c.y>confettiCanvas.height)c.y=0;
    if(c.x>confettiCanvas.width)c.x=0;
  });
  if(confettis.length>0)requestAnimationFrame(updateConfetti);
}
window.onresize=()=>{confettiCanvas.width=window.innerWidth; confettiCanvas.height=window.innerHeight;}
</script>

</body>
</html>
